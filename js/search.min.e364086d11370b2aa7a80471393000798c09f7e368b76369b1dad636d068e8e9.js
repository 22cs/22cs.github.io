document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("search-form"),e=document.getElementById("search-input"),t=document.getElementById("search-results");if(!n||!e)return;let s=[],a="/index.json";fetch(a).then(e=>e.json()).then(e=>{s=e}).catch(e=>{console.error("Error loading search index:",e)}),n.addEventListener("submit",function(n){n.preventDefault();const s=e.value.toLowerCase().trim();if(s.length<2){t.innerHTML="<p>Please enter at least 2 characters to search</p>";return}o(s)}),e.addEventListener("input",function(){const n=e.value.toLowerCase().trim();n.length>=3?o(n):n.length===0&&(t.innerHTML="")});function o(e){const t=s.filter(t=>{const n=t.title.toLowerCase().includes(e),s=t.content.toLowerCase().includes(e),o=t.tags&&t.tags.some(t=>t.toLowerCase().includes(e)),i=t.categories&&t.categories.some(t=>t.toLowerCase().includes(e));return n||s||o||i});r(t,e)}function r(e,n){if(e.length===0){t.innerHTML='<p>No results found for "'+n+'"</p>';return}let s='<div class="search-results-count">'+e.length+" results found</div>";s+='<ul class="search-results-list">',e.forEach(e=>{const t=i(e.title,n),o=c(e.content,n);s+=`
            <li class="search-result-item">
                <a href="${e.permalink}" class="search-result-title">${t}</a>
                <time class="search-result-date">${e.date}</time>
                <div class="search-result-preview">${o}</div>
            </li>`}),s+="</ul>",t.innerHTML=s}function i(e,t){if(!e)return"";const n=new RegExp("("+l(t)+")","gi");return e.replace(n,"<mark>$1</mark>")}function c(e,t){if(!e)return"";const r=200;e=e.replace(/<[^>]*>/g,"");const a=e.toLowerCase().indexOf(t.toLowerCase());if(a===-1)return e.substring(0,r)+"...";let n=Math.max(0,a-60),s=Math.min(e.length,a+t.length+60);for(;n>0&&e[n]!==" "&&e[n]!==".";)n--;for(;s<e.length&&e[s]!==" "&&e[s]!==".";)s++;let o=e.substring(n,s);return n>0&&(o="..."+o),s<e.length&&(o=o+"..."),i(o,t)}function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}})